@tailwind base;
@tailwind components;
@tailwind utilities;

/* Prevent Telegram WebView gestures during gameplay */
html, body {
  overscroll-behavior: none;
  overscroll-behavior-y: none;
  -webkit-overflow-scrolling: auto;
  touch-action: pan-x pan-y;
  position: fixed;
  width: 100%;
  height: 100%;
  overflow: hidden;
}

/* Force GPU acceleration for smooth 60fps animations in Telegram WebView */
.gpu-accelerated,
[data-flying-element] {
  transform: translateZ(0);
  backface-visibility: hidden;
  perspective: 1000px;
  will-change: transform, opacity;
  -webkit-transform: translateZ(0);
  -webkit-backface-visibility: hidden;
}

/* GPU acceleration for all cards - critical for Telegram WebView performance */
[data-card-id] {
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  will-change: transform, opacity;
  -webkit-font-smoothing: antialiased;
}

/* GPU layer for card containers in tableau */
[data-tableau-column] > div {
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

/* GPU layer for waste pile cards */
[data-waste-pile] > div {
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

/* Game board specific - disable all scroll gestures */
[data-game-board] {
  touch-action: none;
  overscroll-behavior: contain;
  -webkit-overflow-scrolling: auto;
}

/* Allow scrolling in modal windows */
[data-scrollable],
.overflow-y-auto,
.overflow-auto {
  touch-action: pan-y !important;
  -webkit-overflow-scrolling: touch !important;
  overscroll-behavior: contain;
  overflow-y: auto !important;
}

/* Scrollable modal content */
[data-scrollable] {
  -webkit-overflow-scrolling: touch !important;
  overflow-y: auto !important;
  overflow-x: hidden;
}

/* Mobile drag and drop improvements */
.dnd-poly-drag-image {
  opacity: 0.9 !important;
  transform: translate3d(0, 0, 0) !important;
  will-change: transform;
  transition: none !important;
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
}

/* Improve touch scrolling performance */
* {
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
  -webkit-user-drag: none;
}

/* Smooth transforms for all draggable elements */
[draggable="true"] {
  touch-action: none;
  -webkit-user-drag: element;
}

/* Desktop: show desktop card, hide mobile card */
.desktop-card {
  display: flex;
}

.mobile-card {
  display: none;
}

/* Mobile: hide desktop card, show mobile card */
@media (max-width: 768px) {
  .desktop-card {
    display: none !important;
  }
  
  .mobile-card {
    display: flex !important;
  }
}

/* Simple fade in animation */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes modalSlideIn {
  from { 
    opacity: 0; 
    transform: scale(0.95);
  }
  to { 
    opacity: 1; 
    transform: scale(1);
  }
}

/* Reward icon drop animation */
@keyframes rewardDrop {
  0% { 
    opacity: 0; 
    transform: translateY(-30px) scale(0.5);
  }
  60% {
    opacity: 1;
    transform: translateY(5px) scale(1.1);
  }
  100% { 
    opacity: 1; 
    transform: translateY(0) scale(1);
  }
}

/* Pop in animation - scales from center */
@keyframes popIn {
  from { 
    opacity: 0; 
    transform: scale(0.9);
  }
  to { 
    opacity: 1; 
    transform: scale(1);
  }
}

/* Card flip animation */
@keyframes slideIn {
  from {
    transform: translateX(-30px);
    opacity: 0.7;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

.animate-slide-in {
  animation: slideIn 200ms ease-out;
}

/* New card slide-in without delay */
.card-slide-in {
  animation: cardSlideIn 250ms ease-out forwards;
}

@keyframes cardSlideIn {
  0% {
    transform: translateX(-33%);
    opacity: 0.5;
  }
  100% {
    transform: translateX(0);
    opacity: 1;
  }
}

/* Click animation for stock pile */
@keyframes clickScale {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.1);
  }
  100% {
    transform: scale(1);
  }
}

.animate-click {
  animation: clickScale 100ms ease-out;
}

@layer base {
  * {
    @apply border-border;
  }
  
  /* Remove all focus outlines */
  *:focus {
    outline: none !important;
    box-shadow: none !important;
  }
  
  /* Remove yellow/orange focus rings */
  *:focus-visible {
    outline: none !important;
    box-shadow: none !important;
  }

  html {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
  }

  body {
    @apply font-sans antialiased bg-background text-foreground;
    margin: 0;
    padding: 0;
    overflow: hidden;
    width: 100vw;
    height: 100vh;
    position: fixed;
    top: 0;
    left: 0;
  }
}

#root {
  width: 100%;
  height: 100%;
  position: fixed;
  top: 0;
  left: 0;
}

canvas {
  width: 100% !important;
  height: 100% !important;
  touch-action: none;
}

/* COMMENTED OUT: Premium card reveal animation - single pulse */
/*
@keyframes premiumReveal {
  0% {
    transform: scale(1);
    filter: brightness(1);
  }
  50% {
    transform: scale(1.15);
    filter: brightness(1.3);
  }
  100% {
    transform: scale(1);
    filter: brightness(1);
  }
}

.premium-card-reveal {
  animation: premiumReveal 500ms ease-in-out;
}

[data-is-premium="true"]:not([data-premium-hidden]).bg-green-950 {
  border-width: 1px !important;
  border-color: rgb(59, 130, 246) !important;
}

[data-is-premium="true"]:not([data-premium-hidden]).bg-amber-50 {
  border-width: 1px !important;
  border-color: rgb(59, 130, 246) !important;
}

[data-is-premium="true"][data-premium-hidden="true"] {
}
*/

/* Card shake animation for invalid moves - sharp and dynamic */
/* Using margin-left to avoid transform conflicts with parent transforms */
@keyframes cardShake {
  0%, 100% { margin-left: 0; }
  10% { margin-left: -5px; }
  20% { margin-left: 5px; }
  30% { margin-left: -5px; }
  40% { margin-left: 5px; }
  50% { margin-left: -4px; }
  60% { margin-left: 4px; }
  70% { margin-left: -3px; }
  80% { margin-left: 3px; }
  90% { margin-left: -2px; }
}

.animate-shake {
  animation: cardShake 280ms linear;
}

/* Key impact animation - quick pulse/scale effect */
@keyframes keyImpact {
  0% {
    transform: scale3d(1, 1, 1);
  }
  40% {
    transform: scale3d(1.08, 1.08, 1);
  }
  100% {
    transform: scale3d(1, 1, 1);
  }
}

.key-impact-effect {
  animation: keyImpact 250ms ease-out;
  will-change: transform;
}

/* Collection button pop animation - quick and snappy */
@keyframes collection-pop {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.15);
  }
  100% {
    transform: scale(1);
  }
}

.animate-collection-pop {
  animation: collection-pop 0.15s ease-out;
}

/* New collection item icon fly-in animation - icon flies into position */
@keyframes new-item-icon-fly-in {
  0% {
    transform: translateY(-40px) scale(0.5);
    opacity: 0;
  }
  50% {
    transform: translateY(4px) scale(1.1);
    opacity: 1;
  }
  70% {
    transform: translateY(-2px) scale(1.05);
  }
  100% {
    transform: translateY(0) scale(1);
  }
}

/* Card dealing animation - cards fly in from stock pile */
@keyframes cardDeal {
  0% {
    transform: translateX(500px) translateY(-200px) rotate(15deg);
    opacity: 0;
  }
  50% {
    opacity: 1;
  }
  100% {
    transform: translateX(0) translateY(0) rotate(0deg);
    opacity: 1;
  }
}

.card-dealing {
  animation: cardDeal 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94) backwards;
}

/* Stock pile dealing animation */
@keyframes stockDeal {
  0% {
    transform: scale(0.8);
    opacity: 0;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.stock-dealing {
  animation: stockDeal 0.3s ease-out backwards;
}

/* Hint glow animation */
@keyframes hintGlow {
  0%, 100% {
    box-shadow: 0 0 10px 3px rgba(255, 215, 0, 0.6), 0 0 20px 6px rgba(255, 215, 0, 0.3);
    transform: scale(1);
  }
  50% {
    box-shadow: 0 0 20px 8px rgba(255, 215, 0, 0.9), 0 0 40px 15px rgba(255, 215, 0, 0.5);
    transform: scale(1.02);
  }
}

.hint-glow {
  animation: hintGlow 0.8s ease-in-out infinite;
  z-index: 100;
  position: relative;
}

/* Level indicator pulse animation */
@keyframes levelPulse {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.15);
  }
  100% {
    transform: scale(1);
  }
}

.animate-level-pulse {
  animation: levelPulse 0.3s ease-out;
}

/* Trophy appear animation */
@keyframes trophy-appear {
  0% {
    opacity: 0;
    transform: translateY(20px) scale(0.8);
  }
  60% {
    transform: translateY(-5px) scale(1.05);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.trophy-appear {
  animation: trophy-appear 0.5s ease-out both;
}

/* Trophy glow animation for celebration screen */
@keyframes trophy-glow {
  0%, 100% {
    filter: drop-shadow(0 0 20px rgba(250, 204, 21, 0.6));
    transform: scale(1);
  }
  50% {
    filter: drop-shadow(0 0 40px rgba(250, 204, 21, 1));
    transform: scale(1.05);
  }
}

/* Collection item pop animation - for reward animation */
@keyframes collection-item-pop {
  0% {
    transform: translate(10px, 10px) scale(1);
    opacity: 0;
  }
  20% {
    transform: translate(0, 0) scale(1);
    opacity: 1;
  }
  60% {
    transform: translate(0, 0) scale(1.15);
  }
  100% {
    transform: translate(0, 0) scale(1);
  }
}

/* Collection header appear animation - for serial rewards */
@keyframes collection-header-appear {
  0% {
    opacity: 0;
    transform: translateY(-15px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Collection icon pop animation - starts when parent reaches max size */
@keyframes collection-icon-pop {
  0% {
    transform: scale(1);
  }
  30% {
    transform: scale(1.4);
  }
  100% {
    transform: scale(1);
  }
}

/* Collection reward icon pulse - grows then shrinks, chip launches at peak */
@keyframes collection-reward-icon-pulse {
  0% {
    transform: scale(1);
    filter: drop-shadow(0 0 0 rgba(251, 146, 60, 0));
  }
  50% {
    transform: scale(1.5);
    filter: drop-shadow(0 0 12px rgba(251, 146, 60, 0.8));
  }
  100% {
    transform: scale(1);
    filter: drop-shadow(0 0 0 rgba(251, 146, 60, 0));
  }
}

/* Key drop animation for Treasure Hunt - face up cards (with bounce) */
@keyframes keyDrop {
  0% {
    transform: translateY(-40px);
    opacity: 0;
  }
  30% {
    opacity: 1;
  }
  70% {
    transform: translateY(5px);
  }
  85% {
    transform: translateY(-3px);
  }
  100% {
    transform: translateY(0);
  }
}

/* Key drop animation for face down cards - no bounce, appears and stays */
@keyframes keyDropFaceDown {
  0% {
    transform: translateY(-40px);
    opacity: 0;
  }
  30% {
    opacity: 1;
  }
  100% {
    transform: translateY(0);
    opacity: 1;
  }
}

/* Key pulse animation for card border */
@keyframes keyPulse {
  0% {
    box-shadow: inset 0 0 0 2px rgba(255, 200, 50, 0.5), 0 0 8px rgba(255, 180, 0, 0.3);
    transform: scale(1);
  }
  50% {
    box-shadow: inset 0 0 0 3px rgba(255, 200, 50, 0.8), 0 0 20px rgba(255, 180, 0, 0.6);
    transform: scale(1.02);
  }
  100% {
    box-shadow: inset 0 0 0 2px rgba(255, 200, 50, 0.5), 0 0 8px rgba(255, 180, 0, 0.3);
    transform: scale(1);
  }
}